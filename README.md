# Starbucks Spider

刚开始学爬虫，这是一个练手用的项目，命名不规范见谅。用 Scrapy 编写的爬虫项目，旨在从 [Starbucks](https://www.starbucks.com.cn/menu/) 网站提取菜单信息，包括菜品名称、图片 URL 等，并将图片下载到本地。星巴克网站似乎更新过了，原来的爬虫都不太能用，不过它的菜单目录依旧藏在**注释**里，正好可以拿来练练手。

## 功能描述

- **提取菜单信息**：从星巴克官网菜单页面提取所有菜品的名称和对应图片的 URL。
- **下载图片**：从提取的 URL 下载每个菜品的图片，并保存在本地目录 `./image` 中。
- **CSV 文件导出**：提取的信息（名称和图片 URL）将被保存到 `starbucks.csv` 文件中。
- **进度条**：在下载图片时显示进度条，方便查看下载进度。

## 目录结构

```
StarbucksSpider/
├── image/                # 下载的图片保存目录
├── my_spider/            # Scrapy 爬虫脚本目录
├── utils/                # 工具类目录
├── ImageDownloader.py    # 下载图片的脚本
├── starbucks.csv         # 保存菜品名称和图片 URL 的 CSV 文件
└── README.md             # 项目文档
```

## 项目依赖

- **运行环境**: Python 3.13.0。

在项目中，我们使用了以下 Python 库：

- **Scrapy**: 用于爬取网站内容。
- **Requests**: 用于下载图片。
- **TQDM**: 用于显示下载进度条。

你可以通过以下步骤安装依赖。

### 安装依赖

   ```bash
   pip install scrapy requests tqdm
   ```

## 如何运行

1. **启动爬虫**：

   使用 Scrapy 命令启动爬虫，爬虫会自动开始从菜单页面抓取数据，并将图片 URL 和名称保存在 `starbucks.csv` 文件中。

   ```bash
   scrapy crawl starbucks 
   ```

2. **下载图片**：

   运行 `ImageDownloader` 类来下载图片。确保爬虫已经运行并生成了 `starbucks.csv` 文件。

   ```bash
   python ImageDownloader.py
   ```

   该脚本会读取 `starbucks.csv` 文件，下载对应的图片，并将其保存在 `./image` 目录下。

### 图片下载进度条

使用 `tqdm` 库，程序会显示每张图片的下载进度，进度条会实时更新。

## 图片保存

下载的图片将按照菜品的名称保存在 `./image` 文件夹下，名称会经过清理以确保合法性。比如：

- 如果菜品名称为 `经典巧克力饮品（热/冷）`，它将被保存为 `经典巧克力饮品_热_冷.jpg`。

### 可能出现的错误

1. **路径问题**：如果菜品名称包含非法字符（如 `/`、`\` 等），程序会自动清理文件名，确保它们是合法的。
2. **图片下载失败**：如果下载某张图片失败，错误信息会被打印出来，但不会影响其他图片的下载。

---

***2024/12/20 listed by guxinghuahuo***